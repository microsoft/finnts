<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Agent Capabilities • finnts</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="AI Agent Capabilities">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-6X0DS5856B"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6X0DS5856B');
</script>
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">finnts</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.0.9003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/finnts.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ai-agent.html">AI Agent Capabilities</a>
    </li>
    <li>
      <a href="../articles/back-testing-and-hyperparameter-tuning.html">Back Testing and Hyperparameter Tuning</a>
    </li>
    <li>
      <a href="../articles/best-model-selection.html">Best Model Selection</a>
    </li>
    <li>
      <a href="../articles/external-regressors.html">External Regressors</a>
    </li>
    <li>
      <a href="../articles/feature-engineering.html">Feature Engineering</a>
    </li>
    <li>
      <a href="../articles/feature-selection.html">Feature Selection</a>
    </li>
    <li>
      <a href="../articles/forecast-components.html">Using Individual finnts Forecast Components</a>
    </li>
    <li>
      <a href="../articles/hierarchical-forecasting.html">Hierarchical Forecasting</a>
    </li>
    <li>
      <a href="../articles/models-used-in-finnts.html">Models Used in finnts</a>
    </li>
    <li>
      <a href="../articles/parallel-processing.html">Parallel Processing</a>
    </li>
    <li>
      <a href="../articles/tips-for-production.html">Tips for Production</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/microsoft/finnts/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>AI Agent Capabilities</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/microsoft/finnts/blob/main/vignettes/ai-agent.Rmd" class="external-link"><code>vignettes/ai-agent.Rmd</code></a></small>
      <div class="hidden name"><code>ai-agent.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="why-an-ai-agent-in-finnts">Why an AI agent in <em>finnts</em>?<a class="anchor" aria-label="anchor" href="#why-an-ai-agent-in-finnts"></a>
</h2>
<p>The AI agent is a <strong>tool-calling orchestration layer</strong>
that sits on top of the core <em>finnts</em> pipeline. It uses an LLM
to:</p>
<ul>
<li>run lightweight EDA (missing data, outliers, (P)ACF, seasonality,
stationarity),</li>
<li>select/adjust <strong>feature recipes</strong> (lags, rolling
windows, Fourier, date feats),</li>
<li>choose <strong>model families</strong> (local vs global;
ARIMA/ETS/LM/Tree/GBM/NN, etc.), backtests, and ensembling,</li>
<li>optionally <strong>detect and use hierarchies</strong> (bottoms-up,
standard, grouped),</li>
<li>generate a <strong>reproducible best run</strong> and a consolidated
<strong>forecast artifact</strong> you can pull with a single call.</li>
</ul>
<p>You keep control through a few inputs (data, horizon, optional
regressors, performance goal, iteration budget); the agent does the
rest.</p>
<p>Core Agent Functions:</p>
<ul>
<li>
<code><a href="../reference/iterate_forecast.html">iterate_forecast()</a></code>: Run the agent to iterate toward a
best forecast run.</li>
<li>
<code><a href="../reference/update_forecast.html">update_forecast()</a></code>: Update forecasts with new data,
using models trained in previous agent runs, optionally re-invoking the
agent if accuracy degrades.</li>
<li>
<code><a href="../reference/ask_agent.html">ask_agent()</a></code>: Ask natural language questions about your
forecast results and get data-driven answers.</li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="what-the-agent-produces">What the agent produces<a class="anchor" aria-label="anchor" href="#what-the-agent-produces"></a>
</h2>
<ul>
<li>A versioned <strong>agent run</strong> (with
<code>agent_version</code> and <code>run_id</code>) and log files.</li>
<li>A <strong>best-run table</strong> per time series with metrics.</li>
<li>A combined <strong>forecast table</strong> (optionally reconciled if
hierarchy is used).</li>
<li>EDA artifacts (missing data, outliers, stationarity, seasonality,
ACF/PACF).</li>
<li>Summaries of trained models (hyperparameters, recipes, feature
importance).</li>
</ul>
<p>Use these helpers to retrieve outputs:</p>
<ul>
<li><code>get_best_agent_run(agent_info)</code></li>
<li><code>get_agent_forecast(agent_info)</code></li>
<li><code>ask_agent(agent_info, question)</code></li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<ul>
<li>Package: <code>finnts</code><br>
</li>
<li>LLM driver: the agent uses an <strong>ellmer</strong> Chat object
for tool calling.
<ul>
<li>Example here shows Azure OpenAI, but any ellmer Chat backend
works.</li>
</ul>
</li>
</ul>
<p>Set up environment variables for Azure OpenAI (example):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span></span>
<span>  AZURE_OPENAI_ENDPOINT    <span class="op">=</span> <span class="st">"&lt;your-endpoint&gt;"</span>,</span>
<span>  AZURE_OPENAI_API_KEY     <span class="op">=</span> <span class="st">"&lt;your-key&gt;"</span>,</span>
<span>  AZURE_OPENAI_API_VERSION <span class="op">=</span> <span class="st">"&lt;api-version&gt;"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="end-to-end-first-run-with-the-ai-agent">End-to-end: first run with the AI agent<a class="anchor" aria-label="anchor" href="#end-to-end-first-run-with-the-ai-agent"></a>
</h2>
<p>Below is a complete flow using the built-in M4 monthly sample.</p>
<div class="section level3">
<h3 id="create-a-project">1) Create a project<a class="anchor" aria-label="anchor" href="#create-a-project"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://microsoft.github.io/finnts/">finnts</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">project</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_project_info.html">set_project_info</a></span><span class="op">(</span></span>
<span>  project_name <span class="op">=</span> <span class="st">"ai_agent_demo"</span>,</span>
<span>  path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="co"># or a persistent folder</span></span>
<span>  combo_variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span><span class="op">)</span>,</span>
<span>  target_variable <span class="op">=</span> <span class="st">"value"</span>,</span>
<span>  date_type <span class="op">=</span> <span class="st">"month"</span>, <span class="co"># day|week|month|quarter|year</span></span>
<span>  fiscal_year_start <span class="op">=</span> <span class="fl">1</span> <span class="co"># fiscal month (1 = Jan)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>Tip: <code>path</code> controls where logs/forecasts/EDA artifacts
are saved.<br>
Supports local filesystem, Azure Blob (via
<code>AzureStor::blob_container</code>), or Microsoft 365 drives
(<code>ms365r</code>) via <code>storage_object</code>.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="bring-data">2) Bring data<a class="anchor" aria-label="anchor" href="#bring-data"></a>
</h3>
<ul>
<li>One row per time series combo/date.</li>
<li>A single Date column named <code>Date</code> (class
<code>Date</code>).</li>
<li>Target column matches <code>target_variable</code>.</li>
<li>Optional <strong>external regressors</strong> as extra columns
(historical <strong>or historical+future</strong> values, if you want
them used in forecasting).</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hist_data</span> <span class="op">&lt;-</span> <span class="fu">timetk</span><span class="fu">::</span><span class="va"><a href="https://business-science.github.io/timetk/reference/m4_monthly.html" class="external-link">m4_monthly</a></span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2013-01-01"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Date <span class="op">=</span> <span class="va">date</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="define-the-llms">3) Define the LLMs<a class="anchor" aria-label="anchor" href="#define-the-llms"></a>
</h3>
<ul>
<li>
<code>driver_llm</code>: executes the workflow via tool
calling.</li>
<li>
<code>reason_llm</code> (optional): does the chain-of-thought style
reasoning / EDA digestion to choose Finn run inputs step-by-step.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">driver_llm</span> <span class="op">&lt;-</span> <span class="fu">ellmer</span><span class="fu">::</span><span class="fu">chat_azure_openai</span><span class="op">(</span>model <span class="op">=</span> <span class="st">"gpt-4o-mini"</span><span class="op">)</span></span>
<span><span class="va">reason_llm</span> <span class="op">&lt;-</span> <span class="fu">ellmer</span><span class="fu">::</span><span class="fu">chat_azure_openai</span><span class="op">(</span>model <span class="op">=</span> <span class="st">"o4-mini"</span><span class="op">)</span> <span class="co"># can be the same or a more advanced reasoning model</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="create-the-agent-run">4) Create the agent run<a class="anchor" aria-label="anchor" href="#create-the-agent-run"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">agent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_agent_info.html">set_agent_info</a></span><span class="op">(</span></span>
<span>  project_info <span class="op">=</span> <span class="va">project</span>,</span>
<span>  driver_llm <span class="op">=</span> <span class="va">driver_llm</span>,</span>
<span>  reason_llm <span class="op">=</span> <span class="va">reason_llm</span>, <span class="co"># optional but recommended</span></span>
<span>  input_data <span class="op">=</span> <span class="va">hist_data</span>,</span>
<span>  forecast_horizon <span class="op">=</span> <span class="fl">6</span>, <span class="co"># number of future periods</span></span>
<span>  external_regressors <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># e.g., c("Price","Promo")</span></span>
<span>  allow_hierarchical_forecast <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># set TRUE to let agent use hierarchies</span></span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># start a fresh run_id if inputs changed</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This writes the versioned inputs into <code>path/input_data/</code>
(hashed by combo/run) and logs the new
<code>agent_version</code>/<code>run_id</code>.</p>
</div>
<div class="section level3">
<h3 id="let-the-agent-iterate-to-a-best-run">5) Let the agent iterate to a best run<a class="anchor" aria-label="anchor" href="#let-the-agent-iterate-to-a-best-run"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/iterate_forecast.html">iterate_forecast</a></span><span class="op">(</span></span>
<span>  agent_info          <span class="op">=</span> <span class="va">agent</span>,</span>
<span>  weighted_mape_goal  <span class="op">=</span> <span class="fl">0.05</span>, <span class="co"># your accuracy target of 5%</span></span>
<span>  max_iter            <span class="op">=</span> <span class="fl">3</span>, <span class="co"># stop after N iterations if not hitting goal</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>What happens under the hood:</p>
<ul>
<li>Reads cached EDA (or computes it) via the agent’s EDA tools.</li>
<li>Chooses <strong>seasonal period</strong>,
<strong>missing/outlier</strong> handling,
<strong>box-cox/differencing</strong> strategy.</li>
<li>Sweeps <strong>models</strong> (local &amp;/or global), backtests,
<strong>recipes</strong> (lags/rolling/Fourier/date feats).</li>
<li>Optionally enables <strong>external regressors</strong> if they
improve WMAPE.</li>
<li>Stops early if MWAPE goal met; otherwise iterates (up to
<code>max_iter</code>).</li>
</ul>
</div>
<div class="section level3">
<h3 id="retrieve-results">6) Retrieve results<a class="anchor" aria-label="anchor" href="#retrieve-results"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">best_runs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_best_agent_run.html">get_best_agent_run</a></span><span class="op">(</span>agent_info <span class="op">=</span> <span class="va">agent</span>, full_run_info <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">best_runs</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fcst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_agent_forecast.html">get_agent_forecast</a></span><span class="op">(</span>agent_info <span class="op">=</span> <span class="va">agent</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fcst</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code>best_runs</code> summarizes, for each time series combo, the
best run inputs when calling the Finn forecast process.</li>
<li>
<code>fcst</code> returns the consolidated forecast table (if
hierarchical reconciliation was used, this is the reconciled
output).</li>
</ul>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="ask-questions-about-your-forecast-results">Ask questions about your forecast results<a class="anchor" aria-label="anchor" href="#ask-questions-about-your-forecast-results"></a>
</h2>
<p>After running <code><a href="../reference/iterate_forecast.html">iterate_forecast()</a></code> or
<code><a href="../reference/update_forecast.html">update_forecast()</a></code>, you can use <code><a href="../reference/ask_agent.html">ask_agent()</a></code> to
ask natural language questions about your results. The agent analyzes
your forecast data, model configurations, and EDA outputs to provide
data-driven answers.</p>
<div class="section level3">
<h3 id="how-it-works">How it works<a class="anchor" aria-label="anchor" href="#how-it-works"></a>
</h3>
<p><code><a href="../reference/ask_agent.html">ask_agent()</a></code> creates an LLM-driven workflow that: 1.
<strong>Plans</strong> the analysis steps needed to answer your question
2. <strong>Executes</strong> R code to analyze the relevant data 3.
<strong>Generates</strong> a natural language answer based on the
results</p>
</div>
<div class="section level3">
<h3 id="example-questions">Example questions<a class="anchor" aria-label="anchor" href="#example-questions"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ask about forecast accuracy</span></span>
<span><span class="va">answer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ask_agent.html">ask_agent</a></span><span class="op">(</span></span>
<span>  agent_info <span class="op">=</span> <span class="va">agent</span>,</span>
<span>  question <span class="op">=</span> <span class="st">"What is the average weighted MAPE across all time series?"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ask about models used</span></span>
<span><span class="va">answer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ask_agent.html">ask_agent</a></span><span class="op">(</span></span>
<span>  agent_info <span class="op">=</span> <span class="va">agent</span>,</span>
<span>  question <span class="op">=</span> <span class="st">"Which models were selected as best for each time series?"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ask about feature importance</span></span>
<span><span class="va">answer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ask_agent.html">ask_agent</a></span><span class="op">(</span></span>
<span>  agent_info <span class="op">=</span> <span class="va">agent</span>,</span>
<span>  question <span class="op">=</span> <span class="st">"What are the top 3 most important features for the forecast models?"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ask about data quality</span></span>
<span><span class="va">answer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ask_agent.html">ask_agent</a></span><span class="op">(</span></span>
<span>  agent_info <span class="op">=</span> <span class="va">agent</span>,</span>
<span>  question <span class="op">=</span> <span class="st">"Were there any missing values or outliers in the data?"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ask about specific forecasts</span></span>
<span><span class="va">answer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ask_agent.html">ask_agent</a></span><span class="op">(</span></span>
<span>  agent_info <span class="op">=</span> <span class="va">agent</span>,</span>
<span>  question <span class="op">=</span> <span class="st">"What are the forecasted values for M750 for the next 3 months?"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ask about time series characteristics</span></span>
<span><span class="va">answer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ask_agent.html">ask_agent</a></span><span class="op">(</span></span>
<span>  agent_info <span class="op">=</span> <span class="va">agent</span>,</span>
<span>  question <span class="op">=</span> <span class="st">"Which time series show strong seasonality patterns?"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ask comparative questions</span></span>
<span><span class="va">answer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ask_agent.html">ask_agent</a></span><span class="op">(</span></span>
<span>  agent_info <span class="op">=</span> <span class="va">agent</span>,</span>
<span>  question <span class="op">=</span> <span class="st">"Which time series have the highest forecast uncertainty?"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="what-data-sources-are-available">What data sources are available<a class="anchor" aria-label="anchor" href="#what-data-sources-are-available"></a>
</h3>
<p><code><a href="../reference/ask_agent.html">ask_agent()</a></code> has access to four main data sources:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Forecast results</strong>
(<code><a href="../reference/get_agent_forecast.html">get_agent_forecast()</a></code>): Future predictions, back-test
results, model selections, confidence intervals</li>
<li>
<strong>Model configurations</strong>
(<code><a href="../reference/get_best_agent_run.html">get_best_agent_run()</a></code>): Feature engineering settings,
transformations applied, model hyperparameters</li>
<li>
<strong>EDA results</strong> (<code><a href="../reference/get_eda_data.html">get_eda_data()</a></code>): Time
series characteristics, seasonality, stationarity tests, data quality
metrics</li>
<li>
<strong>Model summaries</strong>
(<code><a href="../reference/get_summarized_models.html">get_summarized_models()</a></code>): Feature importance, model
parameters, recipe details</li>
</ol>
<p>The agent automatically determines which data sources to use based on
your question.</p>
</div>
<div class="section level3">
<h3 id="tips-for-effective-questions">Tips for effective questions<a class="anchor" aria-label="anchor" href="#tips-for-effective-questions"></a>
</h3>
<ul>
<li>Be specific about what you want to know</li>
<li>Reference specific time series by their combo ID if needed</li>
<li>Ask about metrics, patterns, or comparisons</li>
<li>The agent can perform calculations and aggregations on the fly</li>
</ul>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="updating-with-new-data-production-loop">Updating with new data (production loop)<a class="anchor" aria-label="anchor" href="#updating-with-new-data-production-loop"></a>
</h2>
<p>When you have <strong>new input data</strong>, keep the same project
and create a <strong>new agent run</strong> with updated
<code>input_data</code>. Then call <code><a href="../reference/update_forecast.html">update_forecast()</a></code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># suppose you've appended more months to hist_data:</span></span>
<span><span class="va">hist_data2</span> <span class="op">&lt;-</span> <span class="va">hist_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Date</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2016-06-01"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">agent2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_agent_info.html">set_agent_info</a></span><span class="op">(</span></span>
<span>  project_info <span class="op">=</span> <span class="va">project</span>,</span>
<span>  driver_llm <span class="op">=</span> <span class="va">driver_llm</span>,</span>
<span>  reason_llm <span class="op">=</span> <span class="va">reason_llm</span>,</span>
<span>  input_data <span class="op">=</span> <span class="va">hist_data2</span>,</span>
<span>  forecast_horizon <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># required to create a new agent version when running update_forecast()</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/update_forecast.html">update_forecast</a></span><span class="op">(</span></span>
<span>  agent_info             <span class="op">=</span> <span class="va">agent2</span>,</span>
<span>  weighted_mape_goal     <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  allow_iterate_forecast <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># if degradation detected, allow the agent to re-iterate</span></span>
<span>  max_iter               <span class="op">=</span> <span class="fl">2</span> <span class="co"># cap re-iteration cost</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">updated_fcst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_agent_forecast.html">get_agent_forecast</a></span><span class="op">(</span><span class="va">agent2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ask questions about the updated forecast</span></span>
<span><span class="va">answer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ask_agent.html">ask_agent</a></span><span class="op">(</span></span>
<span>  agent_info <span class="op">=</span> <span class="va">agent2</span>,</span>
<span>  question <span class="op">=</span> <span class="st">"Summarize the forecast accuracy."</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>What <code><a href="../reference/update_forecast.html">update_forecast()</a></code> does:</p>
<ul>
<li>
<strong>Rebuilds global</strong> models first (if used), then
updates local series that need it.</li>
<li>Compares WMAPE to a trailing baseline of previous runs. If &gt;40%
of series are <strong>&gt;20% worse</strong> than the previous run
WMAPE, and <code>allow_iterate_forecast = TRUE</code>, it will
<strong>invoke the iterate loop</strong> (bounded by
<code>max_iter</code>) to recover accuracy.</li>
<li>Re-runs reconciliation if hierarchy is in play.</li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="hierarchies-optional">Hierarchies (optional)<a class="anchor" aria-label="anchor" href="#hierarchies-optional"></a>
</h2>
<p>Set <code>allow_hierarchical_forecast = TRUE</code> in
<code><a href="../reference/set_agent_info.html">set_agent_info()</a></code> to let the agent detect:</p>
<ul>
<li>
<em>none</em> → use <code>bottoms_up</code> (default),</li>
<li>
<em>standard hierarchy</em> (e.g., Region → Country → SKU),</li>
<li>
<em>grouped hierarchy</em> (crossed dimensions).</li>
</ul>
<p>When the agent selects a hierarchy, it will: - train at the selected
aggregate(s), - <strong>reconcile</strong> down to the bottom level, -
produce a <strong>reconciled</strong> <code><a href="../reference/get_agent_forecast.html">get_agent_forecast()</a></code>
output.</p>
<p>For background and manual control, see the <strong>“Hierarchical
Forecasting”</strong> vignette.</p>
<hr>
</div>
<div class="section level2">
<h2 id="external-regressors-xregs">External regressors (xregs)<a class="anchor" aria-label="anchor" href="#external-regressors-xregs"></a>
</h2>
<p>If you pass
<code>external_regressors = c("Price","Promo", ...)</code>:</p>
<ul>
<li>Provide <strong>historical or historical+future values</strong>
(length ≥ horizon) in your <code>input_data</code> for the selected
columns.</li>
<li>The agent will <strong>test</strong> which specific xregs help; if
they don’t, it will disable them for that iteration.</li>
<li>See the <strong>“External Regressors”</strong> vignette for data
prep details.</li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="parallelism-knobs">Parallelism knobs<a class="anchor" aria-label="anchor" href="#parallelism-knobs"></a>
</h2>
<ul>
<li>
<code>parallel_processing = "local_machine"</code> runs each time
series in parallel across local cores.<br>
</li>
<li>
<code>parallel_processing = "spark"</code> executes combos on an
Azure Databricks/Synapse Spark cluster (see <strong>“Parallel
Processing”</strong> vignette).<br>
</li>
<li>
<code>inner_parallel = TRUE</code> parallelizes work
<strong>inside</strong> a combo (useful when outer parallelism is
<code>NULL</code> or <code>"spark"</code>).<br>
</li>
<li>
<code>num_cores = NULL</code> defaults to <em>all cores minus
one</em>.</li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="reading-artifacts-directly-optional">Reading artifacts directly (optional)<a class="anchor" aria-label="anchor" href="#reading-artifacts-directly-optional"></a>
</h2>
<p>You normally won’t need this, but for audits:</p>
<ul>
<li>Inputs: <code>path/input_data/…</code>
</li>
<li>EDA: <code>path/eda/…</code>
</li>
<li>Logs: <code>path/logs/…</code> (includes the hashed
<code>*-agent_run.csv</code> and <code>*-agent_best_run.*</code> for
each version)</li>
<li>Final Agent Outputs: <code>path/final_output/…</code>
</li>
</ul>
<p>Use the helpers first; dig into files only if you must.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://www.linkedin.com/in/michaeltokic/" class="external-link">Mike Tokic</a>, <a href="https://aadharshkannan.com/" class="external-link">Aadharsh Kannan</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
